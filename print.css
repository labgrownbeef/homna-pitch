/**
 * HOMNA Pitch Deck - PDF Export Stylesheet
 * This stylesheet optimizes the presentation for PDF export and digital viewing
 */

@media print {
    /* Force background colors and images to print */
    html {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important;
    }
    /* General reset */
    * {
        box-sizing: border-box !important;
    }
    
    /* Body setup for A4 landscape mode */
    @page {
        size: A4 landscape;
        margin: 0.25in;
    }
    
    body {
        margin: 0 !important;
        padding: 0 !important;
        background-color: var(--primary) !important;
        color: var(--secondary) !important;
        font-family: 'Karla', sans-serif !important;
        line-height: 1.4 !important;
        width: 100% !important;
        height: auto !important;
        overflow: visible !important;
        print-color-adjust: exact !important;
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }
    
    /* Each slide gets a page break */
    .slide {
        width: 100% !important;
        height: 210mm !important; /* A4 landscape height */
        max-height: 210mm !important;
        width: 297mm !important; /* A4 landscape width */
        max-width: 297mm !important;
        overflow: hidden !important;
        page-break-after: always !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
        display: block !important;
        position: relative !important;
        padding: 20px 30px !important;
        background-color: var(--primary) !important;
        color: var(--secondary) !important;
        box-sizing: border-box !important;
        box-shadow: none !important;
    }
    
    /* Ensure dark background appears in PDF */
    .slide::before {
        content: "" !important;
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        background-color: #0D0D13 !important; /* Hardcoded primary color */
        z-index: -1 !important;
    }
    
    /* Fixed positioning becomes static for print */
    .slide-header, 
    .slide-footer, 
    .navigation,
    .progress-container,
    .help-icon,
    .help-panel {
        position: static !important;
    }
    
    /* Hide navigation elements */
    .navigation, 
    .fullscreen-btn,
    .home-btn,
    .progress-container,
    .help-icon,
    .help-panel {
        display: none !important;
    }
    
    /* Adjust slide content for print */
    .slide-content {
        max-width: 100% !important;
        width: 100% !important;
        margin: 30px auto 20px !important;
        z-index: 10 !important;
        max-height: calc(210mm - 80px) !important; /* Adjust for A4 landscape height minus margins/headers */
        overflow: visible !important;
    }
    
    /* Text colors and sizing for print */
    h1 {
        color: var(--secondary) !important;
        font-size: 2.8rem !important;
        margin-bottom: 20px !important;
    }
    
    h2 {
        color: var(--secondary) !important;
        font-size: 2rem !important;
        margin-bottom: 15px !important;
    }
    
    h3, h4 {
        color: var(--secondary) !important;
        margin-top: 10px !important;
        margin-bottom: 8px !important;
    }
    
    p {
        color: var(--dark-text) !important;
        margin-bottom: 10px !important;
    }
    
    .subtitle {
        color: var(--accent) !important; /* Keep accent color for subtitles */
        font-size: 1.6rem !important;
    }
    
    /* Watermark adjustment for print */
    .watermark {
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) rotate(-45deg) !important;
        color: rgba(255, 255, 255, 0.05) !important;
        z-index: 1 !important;
    }
    
    /* Adjust tables for print */
    table {
        width: 100% !important;
        border-collapse: collapse !important;
        page-break-inside: avoid !important;
        font-size: 0.9rem !important;
        margin: 15px 0 !important;
    }
    
    th, td {
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        padding: 6px 8px !important;
        text-align: left !important;
    }
    
    /* Adjust images for print */
    img {
        max-width: 100% !important;
        height: auto !important;
        page-break-inside: avoid !important;
        display: block !important;
    }
    
    /* Logo sizing - fixed explicit sizes for PDF export */
    .logo, img[alt="HOMNA Logo"] {
        height: 30px !important;
        width: auto !important;
        max-height: 30px !important;
        object-fit: contain !important;
        margin-top: 10px !important;
        display: block !important;
    }
    
    .logo-large, .slide-content img[src="HomnaWhite.png"] {
        width: 150px !important;
        max-width: 150px !important;
        height: auto !important;
        margin-bottom: 25px !important;
        display: block !important;
        object-fit: contain !important;
    }
    
    /* Logo container positioning */
    .slide-header {
        display: flex !important;
        align-items: center !important;
        padding: 0 !important;
        margin-bottom: 20px !important;
        position: relative !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        z-index: 10 !important;
    }
    
    /* Fix for Saudi Vision logo on slide 3 */
    .slide[data-slide="3"] .slide-header img[src="SaudiVision.png"] {
        height: 35px !important;
        width: auto !important;
        display: block !important;
        margin-left: auto !important;
    }
    
    /* Make sure dark backgrounds with light text print well */
    .highlight-box, 
    .kpi-card,
    .strategy-card {
        background-color: rgba(255, 255, 255, 0.05) !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        color: var(--secondary) !important;
        padding: 12px !important;
        margin: 12px 0 !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
    }
    
    /* Metrics and cards optimization */
    .metrics-grid, 
    div[style*="display: flex; justify-content: space-between"] {
        display: flex !important;
        justify-content: space-between !important;
        gap: 10px !important;
        width: 100% !important;
        margin: 15px 0 !important;
    }
    
    .metric-card {
        flex: 1 !important;
        padding: 10px !important;
        text-align: center !important;
        background-color: rgba(255, 255, 255, 0.05) !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        border-radius: 6px !important;
        page-break-inside: avoid !important;
    }
    
    /* List adjustments */
    ul.custom-list {
        margin-bottom: 10px !important;
        padding-left: 20px !important;
    }
    
    ul.custom-list li {
        margin-bottom: 4px !important;
    }
    
    /* Ensure footer content appears */
    .slide-footer {
        bottom: 12px !important;
        left: 30px !important;
        right: 30px !important;
        position: absolute !important;
        width: calc(100% - 60px) !important;
        display: flex !important;
        justify-content: space-between !important;
        font-size: 9pt !important;
        color: rgba(255,255,255,0.5) !important;
    }
    
    /* Page numbers */
    .page-number {
        bottom: 12px !important;
        position: absolute !important;
        width: 100% !important;
        text-align: center !important;
        font-size: 9pt !important;
        color: rgba(255,255,255,0.5) !important;
        z-index: 100 !important;
    }
    
    /* For two-column layouts */
    .two-column {
        display: flex !important;
        flex-direction: row !important;
        gap: 20px !important;
        width: 100% !important;
        margin: 15px 0 !important;
    }
    
    .column {
        flex: 1 !important;
        min-width: 0 !important; /* Ensures columns can shrink if needed */
    }
    
    /* Team grid adjustments */
    .team-grid {
        display: grid !important;
        grid-template-columns: repeat(3, 1fr) !important;
        gap: 15px !important;
        margin: 15px 0 !important;
        width: 100% !important;
    }
    
    .team-card {
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        background-color: rgba(255, 255, 255, 0.05) !important;
        padding: 12px !important;
        border-radius: 6px !important;
        page-break-inside: avoid !important;
        break-inside: avoid !important;
    }
    
    .team-info h3 {
        font-size: 1.1rem !important;
        margin-bottom: 3px !important;
    }
    
    .team-role {
        font-size: 0.9rem !important;
        margin-bottom: 5px !important;
    }
    
    .team-info p {
        font-size: 0.8rem !important;
        line-height: 1.3 !important;
    }
}